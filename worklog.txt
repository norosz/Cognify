[2026-01-25 13:38] Antigravity
DONE: Read project specs; Created feature branch `feature/models-and-migrations`; Implemented EF Core Entities (User, Module, Document, Note, QuestionSet, Question, Attempt); Implemented `ApplicationDbContext`; Configured SQL Server in AppHost (Port 14333, Persistent); Generated `InitialCreate` migration.
CHANGED: Added `Cognify.Server/Models/*.cs`, `Cognify.Server/Data/ApplicationDbContext.cs`, `Cognify.Server/Migrations/*`; Updated `Cognify.Server/Program.cs`, `Cognify.AppHost/AppHost.cs`.
DECISIONS: Used `Guid` for all IDs; Structured entities in `Models/` and context in `Data/` as per backend rules; Fixed SQL port to 14333 and password to parameter for dev convenience.
NEXT: Implement JWT Authentication Service and Endpoints.
BLOCKERS: None.

[2026-01-25 13:42] Antigravity
DONE: Created `PROJECT_RULES.md` defining agent workflow and documentation standards.
CHANGED: Added `PROJECT_RULES.md`.
DECISIONS: Formalized the rule to read context files and maintain `status.md`/`worklog.txt` in a dedicated rules file.
NEXT: Implement JWT Authentication Service.
BLOCKERS: None.

[2026-01-25 14:48] Antigravity
DONE: Implemented JWT Authentication (Backend). Added `RegisterDto`, `LoginDto`, `AuthResponseDto`. Implemented `PasswordHasher` (BCrypt) and `AuthService`. Created `AuthController` with Login/Register endpoints. Configured JWT Bearer Auth in `Program.cs` and `appsettings.json`.
CHANGED: Added `Cognify.Server/Dtos/Auth/*.cs`, `Cognify.Server/Services/AuthService.cs`, `Cognify.Server/Controllers/AuthController.cs`. Updated `Cognify.Server/Program.cs`, `Cognify.Server/appsettings.json`.
DECISIONS: Used BCrypt for password hashing; JWT tokens expire in 24 hours; Dev secret key used in `appsettings.json`.
NEXT: Implement Module Service and Controller.
BLOCKERS: None.

[2026-01-25 14:50] Antigravity
DONE: Refactored `Services/Abstractions` to `Services/Interfaces`. Updated `BACKEND_AGENT_RULES.md` to reflect this convention.
CHANGED: Renamed `Cognify.Server/Services/Abstractions/` to `Interfaces/`. Updated namespaces in `AuthService.cs`, `PasswordHasher.cs`, `AuthController.cs`, `Program.cs`. Updated `BACKEND_AGENT_RULES.md`.
DECISIONS: Convention change to prefer `Interfaces` over `Abstractions`.
NEXT: Implement Module Service and Controller.
BLOCKERS: None.

[2026-01-25 14:55] Antigravity
DONE: Fixed runtime errors by adding `AddAuthorization()` and `AddControllers()` to `Program.cs`.
CHANGED: Updated `Cognify.Server/Program.cs`.
DECISIONS: None.
NEXT: Implement Module Service and Controller.
BLOCKERS: None.

[2026-01-25 14:58] Antigravity
DONE: Added automatic database migration at startup.
CHANGED: Updated `Cognify.Server/Program.cs`.
DECISIONS: Calling `Database.Migrate()` on startup ensures dev environment DB is always up to date.
NEXT: Implement Module Service and Controller.
BLOCKERS: None.

[2026-01-25 15:57] Antigravity
DONE: Implemented Backend Integration Tests (xUnit, SQLite InMemory). Implemented Frontend Authentication (Angular, Material).
Detailed:
- Created `Cognify.Tests` project with unit/integration tests for Auth.
- Refactored `Cognify.Server/Program.cs` to support test environments.
- Implemented Frontend Auth: Service, Interceptor, Guard.
- Implemented Frontend UI: Login, Register (Angular Material).
- Configured API Proxy (`proxy.conf.js`).
- Refactored frontend auth models to `auth.models.ts`.
CHANGED: Added `Cognify.Tests/*`, `cognify.client/src/app/core/auth/*`, `cognify.client/src/app/features/auth/*`, `cognify.client/proxy.conf.js`.
DECISIONS: Used SQLite In-Memory for integration tests; Used Angular Signals for AuthService state; Configured proxy to avoid CORS issues during dev.
NEXT: Implement Module Service and Controller.
BLOCKERS: None.

[2026-01-25 16:04] Antigravity
DONE: Implemented and Verified Frontend Unit Tests (17/17 Passed).
Detailed:
- Implemented unit tests for `AuthService`, `AuthGuard`, `AuthInterceptor`.
- Implemented component tests for `LoginComponent` and `RegisterComponent`.
- Fixed `app.component.spec.ts` to align with template changes.
- Configured `provideRouter` and `provideHttpClientTesting` in spec files.
CHANGED: Updated `*.spec.ts` files in `cognify.client`.
DECISIONS: Used `provideRouter([])` and spied on injected `Router` for component tests to ensure `RouterLink` compatibility.
NEXT: Push changes and wait for further instructions.
BLOCKERS: None.

[2026-01-25 16:29] Antigravity
DONE: Implemented Backend functionality for Modules Management.
Detailed:
- Created `Module` entity and DTOs.
- Implemented `ModuleService` (CRUD, Owner Validation).
- Created `ModulesController` with API endpoints.
- Implemented `ModulesControllerTests` (Integration Tests).
- Registered `ModuleService` in `Program.cs`.
CHANGED: Added `Cognify.Server/Services/ModuleService.cs`, `Cognify.Server/Controllers/ModulesController.cs`, `Cognify.Tests/Controllers/ModulesControllerTests.cs`.
DECISIONS: Enforced ownership check in Service layer; Tests cover CRUD and cross-user access restrictions.
NEXT: Implement Frontend Modules Service and Components.
BLOCKERS: None.

[2026-01-26 11:37] Antigravity
DONE: Refactored ModuleService and ModulesController to use internal UserContext injection.
Detailed:
- Removed userId parameter from IModuleService and ModuleService methods.
- Injected IUserContextService into ModuleService to retrieve userId internally.
- Updated ModulesController to rely on the simplified IModuleService contract.
- Verified changes with ModulesControllerTests (14/14 passed).
CHANGED: Cognify.Server/Services/Interfaces/IModuleService.cs, Cognify.Server/Services/ModuleService.cs, Cognify.Server/Controllers/ModulesController.cs.
DECISIONS: Moved user ID retrieval logic into the Service layer to cleaner Controller signature and better encapsulation.
NEXT: Implement Frontend Modules Components.
BLOCKERS: None.

