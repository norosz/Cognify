<div class="notes-container">
    <div class="header-actions">
        <h3>Notes</h3>
        <button mat-raised-button color="primary" (click)="openEditor()">
            <mat-icon>add</mat-icon> New Note
        </button>
    </div>

    <div *ngIf="isLoading()" class="loading-spinner">
        <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
    </div>

    <div *ngIf="!isLoading()" class="notes-grid">
        <div *ngIf="notes().length === 0" class="empty-state">
            <mat-icon>note_add</mat-icon>
            <p>No notes yet. Create one to get started!</p>
        </div>

        <mat-card *ngFor="let note of notes()" class="note-card cognify-glass-card" (click)="openEditor(note)">
            <mat-card-header>
                <mat-card-title>{{ note.title }}</mat-card-title>
                <mat-card-subtitle>{{ note.createdAt | date:'medium' }}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
                <p class="note-preview">{{ note.content }}</p>
            </mat-card-content>
            <mat-card-actions align="end" (click)="$event.stopPropagation()">
                <button mat-icon-button (click)="generateQuiz(note); $event.stopPropagation()"
                    matTooltip="Generate Quiz">
                    <mat-icon>psychology</mat-icon>
                </button>
                <button mat-icon-button [matMenuTriggerFor]="menu">
                    <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #menu="matMenu">
                    <button mat-menu-item (click)="openEditor(note)">
                        <mat-icon>edit</mat-icon> Edit
                    </button>
                    <button mat-menu-item class="delete-item" (click)="deleteNote(note)">
                        <mat-icon color="warn">delete</mat-icon> Delete
                    </button>
                </mat-menu>
            </mat-card-actions>
        </mat-card>
    </div>
</div>