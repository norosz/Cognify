<div class="quiz-container">
    <div *ngIf="isLoading()" class="loading-spinner">
        <mat-spinner diameter="40"></mat-spinner>
    </div>

    <div *ngIf="!isLoading()">
        <mat-card *ngIf="quizzes().length === 0" class="empty-state cognify-glass-card">
            <mat-card-content class="empty-state-content">
                <mat-icon>quiz</mat-icon>
                <p>No quizzes available yet. Generate one from your notes!</p>
            </mat-card-content>
        </mat-card>

        <div class="grid">
            <mat-card
                *ngFor="let item of quizzes()"
                class="quiz-card cognify-glass-card"
                [routerLink]="['/quizzes', item.quiz.id]"
                [queryParams]="{ returnTo: '/modules/' + moduleId }">
                <mat-card-header>
                    <div mat-card-avatar>
                        <mat-icon>{{ getQuizTypeInfo(item.quiz.type).icon }}</mat-icon>
                    </div>
                    <mat-card-title class="accent-text">
                        {{ item.quiz.title || 'Untitled Quiz' }}
                    </mat-card-title>
                    <mat-card-subtitle>
                        <div class="subtitle-content">
                            <span>From note: {{ item.noteTitle }}</span>
                        </div>
                    </mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                    <div class="type-badge-container">
                        <span class="type-badge">
                            {{ getQuizTypeInfo(item.quiz.type).label }}
                        </span>
                        <span class="difficulty-badge" [ngClass]="getDifficultyClass(item.quiz.difficulty)">
                            {{ item.quiz.difficulty || 'Intermediate' }}
                        </span>
                    </div>
                    <p class="question-count">
                        <mat-icon>format_list_numbered</mat-icon>
                        <span *ngIf="item.quiz.questions">{{ item.quiz.questions.length }} Questions</span>
                        <span *ngIf="!item.quiz.questions" class="text-error">No Questions Data</span>
                    </p>
                    <p class="date">Created: {{ item.quiz.createdAt | date }}</p>
                </mat-card-content>
                <mat-card-actions align="end">
                    <button mat-icon-button color="warn" (click)="$event.stopPropagation(); deleteQuiz(item.quiz)">
                        <mat-icon>delete</mat-icon>
                    </button>
                    <button mat-flat-button color="primary" (click)="$event.stopPropagation(); takeQuiz(item.quiz)">
                        Take Quiz
                    </button>
                </mat-card-actions>
            </mat-card>
        </div>
    </div>
</div>